<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:VivaVoz.ViewModels"
        x:Class="VivaVoz.Views.OnboardingWindow"
        Title="Welcome to VivaVoz"
        Width="560"
        Height="480"
        CanResize="False"
        WindowStartupLocation="CenterScreen"
        Icon="avares://VivaVoz/Assets/vivavoz.ico">

  <Grid RowDefinitions="Auto,*,Auto">

    <!-- Step indicator bar -->
    <Border Grid.Row="0" Padding="24,16" BorderThickness="0,0,0,1" BorderBrush="#1FFFFFFF">
      <Grid ColumnDefinitions="*,Auto">
        <TextBlock Grid.Column="0"
                   Text="Getting Started"
                   FontSize="13"
                   Opacity="0.6"
                   VerticalAlignment="Center" />
        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="6" VerticalAlignment="Center">
          <!-- Step dots -->
          <Ellipse Width="8" Height="8"
                   Fill="{Binding IsStep1, Converter={x:Static BoolConverters.IsTrue}, ConverterParameter='#FFFFFF'}"
                   Opacity="{Binding IsStep1, Converter={x:Static BoolConverters.IsTrue}, ConverterParameter='1.0'}" />
          <Ellipse Width="8" Height="8"
                   Fill="{Binding IsStep2, Converter={x:Static BoolConverters.IsTrue}, ConverterParameter='#FFFFFF'}"
                   Opacity="{Binding IsStep2, Converter={x:Static BoolConverters.IsTrue}, ConverterParameter='1.0'}" />
          <Ellipse Width="8" Height="8"
                   Fill="{Binding IsStep3, Converter={x:Static BoolConverters.IsTrue}, ConverterParameter='#FFFFFF'}"
                   Opacity="{Binding IsStep3, Converter={x:Static BoolConverters.IsTrue}, ConverterParameter='1.0'}" />
          <Ellipse Width="8" Height="8"
                   Fill="{Binding IsStep4, Converter={x:Static BoolConverters.IsTrue}, ConverterParameter='#FFFFFF'}"
                   Opacity="{Binding IsStep4, Converter={x:Static BoolConverters.IsTrue}, ConverterParameter='1.0'}" />
        </StackPanel>
      </Grid>
    </Border>

    <!-- Step content area -->
    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
      <Grid>

        <!-- â”€â”€ Step 1: Welcome â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <StackPanel IsVisible="{Binding IsStep1}"
                    Spacing="20"
                    Margin="40,32"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center">

          <Image Source="avares://VivaVoz/Assets/vivavoz.ico"
                 Width="72" Height="72"
                 HorizontalAlignment="Center" />

          <TextBlock Text="Welcome to VivaVoz!"
                     FontSize="28"
                     FontWeight="Bold"
                     HorizontalAlignment="Center" />

          <TextBlock Text="Your voice, alive."
                     FontSize="16"
                     Opacity="0.7"
                     HorizontalAlignment="Center" />

          <StackPanel Spacing="12" Margin="0,8,0,0">
            <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto" ColumnSpacing="12">
              <TextBlock Grid.Column="0" Text="ðŸŽ™" FontSize="20" VerticalAlignment="Center" />
              <StackPanel Grid.Column="1" Spacing="2">
                <TextBlock Text="Record" FontWeight="SemiBold" />
                <TextBlock Text="Capture your voice with a single hotkey from anywhere."
                           FontSize="12" Opacity="0.6" TextWrapping="Wrap" />
              </StackPanel>
            </Grid>

            <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto" ColumnSpacing="12">
              <TextBlock Grid.Column="0" Text="âœï¸" FontSize="20" VerticalAlignment="Center" />
              <StackPanel Grid.Column="1" Spacing="2">
                <TextBlock Text="Transcribe" FontWeight="SemiBold" />
                <TextBlock Text="Instantly convert speech to text using Whisper AI."
                           FontSize="12" Opacity="0.6" TextWrapping="Wrap" />
              </StackPanel>
            </Grid>

            <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto" ColumnSpacing="12">
              <TextBlock Grid.Column="0" Text="ðŸ“‹" FontSize="20" VerticalAlignment="Center" />
              <StackPanel Grid.Column="1" Spacing="2">
                <TextBlock Text="Paste" FontWeight="SemiBold" />
                <TextBlock Text="Automatically copy text to clipboard and paste anywhere."
                           FontSize="12" Opacity="0.6" TextWrapping="Wrap" />
              </StackPanel>
            </Grid>
          </StackPanel>

          <TextBlock Text="Let's set up VivaVoz in a few quick steps."
                     FontSize="13"
                     Opacity="0.6"
                     HorizontalAlignment="Center"
                     Margin="0,8,0,0" />
        </StackPanel>

        <!-- â”€â”€ Step 2: Model Selection â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <StackPanel IsVisible="{Binding IsStep2}"
                    Spacing="16"
                    Margin="40,32">

          <TextBlock Text="Choose a Transcription Model"
                     FontSize="22"
                     FontWeight="Bold" />

          <TextBlock Text="Base is pre-selected and works great. Download Medium or Large for better accuracy on complex speech."
                     FontSize="13"
                     Opacity="0.7"
                     TextWrapping="Wrap" />

          <ItemsControl ItemsSource="{Binding Models}">
            <ItemsControl.ItemTemplate>
              <DataTemplate DataType="{x:Type vm:ModelItemViewModel}">
                <Border Padding="0,8"
                        BorderThickness="0,0,0,1"
                        BorderBrush="#10FFFFFF">
                  <Grid ColumnDefinitions="*,Auto,Auto,Auto,Auto">

                    <StackPanel Grid.Column="0" VerticalAlignment="Center" Spacing="2">
                      <StackPanel Orientation="Horizontal" Spacing="8">
                        <TextBlock Text="{Binding DisplayName}" FontWeight="Medium" />
                        <TextBlock Text="{Binding ExpectedSize}" FontSize="11" Opacity="0.55" VerticalAlignment="Center" />
                      </StackPanel>
                      <TextBlock Text="{Binding StatusText}" FontSize="11" Opacity="0.6" />
                    </StackPanel>

                    <ProgressBar Grid.Column="1"
                                 Value="{Binding DownloadProgress}"
                                 Minimum="0" Maximum="1"
                                 IsVisible="{Binding IsDownloading}"
                                 Width="80" Height="4"
                                 VerticalAlignment="Center"
                                 Margin="8,0" />

                    <Button Grid.Column="2"
                            Content="Cancel"
                            Command="{Binding CancelDownloadCommand}"
                            IsVisible="{Binding CanCancel}"
                            Padding="8,4"
                            Margin="4,0,0,0" />

                    <Button Grid.Column="2"
                            Content="Download"
                            Command="{Binding DownloadCommand}"
                            IsVisible="{Binding CanDownload}"
                            Padding="8,4"
                            Margin="4,0,0,0" />

                    <Button Grid.Column="3"
                            Content="Use"
                            Command="{Binding SelectCommand}"
                            IsVisible="{Binding CanSelect}"
                            Padding="8,4"
                            Margin="4,0,0,0" />

                    <TextBlock Grid.Column="3"
                               Text="Active"
                               IsVisible="{Binding IsSelected}"
                               VerticalAlignment="Center"
                               FontSize="11"
                               Opacity="0.7"
                               Margin="4,0,0,0" />

                    <Button Grid.Column="4"
                            Content="Delete"
                            Command="{Binding DeleteCommand}"
                            IsVisible="{Binding CanDelete}"
                            Padding="8,4"
                            Margin="4,0,0,0" />
                  </Grid>
                </Border>
              </DataTemplate>
            </ItemsControl.ItemTemplate>
          </ItemsControl>

          <TextBlock Text="You can always download more models later in Settings."
                     FontSize="12"
                     Opacity="0.5"
                     Margin="0,4,0,0" />
        </StackPanel>

        <!-- â”€â”€ Step 3: Test Recording â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <StackPanel IsVisible="{Binding IsStep3}"
                    Spacing="20"
                    Margin="40,32">

          <TextBlock Text="Test Your Microphone"
                     FontSize="22"
                     FontWeight="Bold" />

          <TextBlock Text="Press Record, speak a few words, then press Stop. VivaVoz will transcribe your test recording so you can see it in action."
                     FontSize="13"
                     Opacity="0.7"
                     TextWrapping="Wrap" />

          <StackPanel Orientation="Horizontal" Spacing="12" Margin="0,8,0,0">
            <Button Content="âº  Record"
                    Command="{Binding StartTestRecordingCommand}"
                    Padding="16,8"
                    FontSize="14" />

            <Button Content="â¹  Stop"
                    Command="{Binding StopTestRecordingCommand}"
                    Padding="16,8"
                    FontSize="14" />
          </StackPanel>

          <Border IsVisible="{Binding IsTestRecording}"
                  Background="#3300FF00"
                  BorderBrush="#4400FF00"
                  BorderThickness="1"
                  CornerRadius="6"
                  Padding="12,8">
            <TextBlock Text="ðŸ”´  Recording... speak now"
                       FontSize="13"
                       Foreground="#88FF88" />
          </Border>

          <Border IsVisible="{Binding IsTestTranscribing}"
                  Background="#33FFFFFF"
                  CornerRadius="6"
                  Padding="12,8">
            <TextBlock Text="â³  Transcribing..."
                       FontSize="13"
                       Opacity="0.8" />
          </Border>

          <Border IsVisible="{Binding HasTestRecorded}"
                  Background="#1AFFFFFF"
                  BorderBrush="#1FFFFFFF"
                  BorderThickness="1"
                  CornerRadius="6"
                  Padding="12,10">
            <StackPanel Spacing="4">
              <TextBlock Text="Transcription result:"
                         FontSize="11"
                         Opacity="0.55" />
              <TextBlock Text="{Binding TestTranscript}"
                         FontSize="14"
                         TextWrapping="Wrap" />
            </StackPanel>
          </Border>

          <TextBlock Text="You can skip this step if you want to set up later."
                     FontSize="12"
                     Opacity="0.5"
                     Margin="0,4,0,0" />
        </StackPanel>

        <!-- â”€â”€ Step 4: Hotkey Setup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <StackPanel IsVisible="{Binding IsStep4}"
                    Spacing="20"
                    Margin="40,32">

          <TextBlock Text="Set Your Recording Hotkey"
                     FontSize="22"
                     FontWeight="Bold" />

          <TextBlock Text="Use this hotkey to start and stop recording from anywhere â€” even when VivaVoz is in the background."
                     FontSize="13"
                     Opacity="0.7"
                     TextWrapping="Wrap" />

          <Border Background="#1AFFFFFF"
                  BorderBrush="#1FFFFFFF"
                  BorderThickness="1"
                  CornerRadius="8"
                  Padding="20,16">
            <StackPanel Spacing="12">
              <TextBlock Text="Current hotkey:"
                         FontSize="12"
                         Opacity="0.55" />
              <StackPanel Orientation="Horizontal" Spacing="16" VerticalAlignment="Center">
                <TextBlock Text="{Binding HotkeyDisplayText}"
                           FontSize="20"
                           FontWeight="SemiBold"
                           VerticalAlignment="Center" />
                <Button Content="Set"
                        Command="{Binding StartSetHotkeyCommand}"
                        IsEnabled="{Binding !IsListeningForHotkey}"
                        Padding="12,6" />
              </StackPanel>

              <TextBlock IsVisible="{Binding IsListeningForHotkey}"
                         Text="Press your desired key combination now..."
                         FontSize="12"
                         Foreground="#AAAAFF"
                         FontStyle="Italic" />
            </StackPanel>
          </Border>

          <StackPanel Spacing="8" Margin="0,4,0,0">
            <TextBlock Text="Tips:"
                       FontSize="12"
                       Opacity="0.6"
                       FontWeight="SemiBold" />
            <TextBlock Text="â€¢ Press the hotkey once to start recording, press it again to stop."
                       FontSize="12"
                       Opacity="0.55"
                       TextWrapping="Wrap" />
            <TextBlock Text="â€¢ Works globally â€” even when other apps are in focus."
                       FontSize="12"
                       Opacity="0.55"
                       TextWrapping="Wrap" />
            <TextBlock Text="â€¢ You can change this anytime in Settings."
                       FontSize="12"
                       Opacity="0.55"
                       TextWrapping="Wrap" />
          </StackPanel>

          <TextBlock Text="Click Finish to start using VivaVoz!"
                     FontSize="14"
                     FontWeight="Medium"
                     Opacity="0.8"
                     Margin="0,8,0,0" />
        </StackPanel>

      </Grid>
    </ScrollViewer>

    <!-- Navigation buttons -->
    <Border Grid.Row="2"
            Padding="24,16"
            BorderThickness="0,1,0,0"
            BorderBrush="#1FFFFFFF">
      <Grid ColumnDefinitions="Auto,*,Auto,Auto">

        <Button Grid.Column="0"
                Content="â† Back"
                Command="{Binding PreviousCommand}"
                IsVisible="{Binding CanGoPrevious}"
                Padding="16,8" />

        <TextBlock Grid.Column="1"
                   Text="{Binding CurrentStep, StringFormat='Step {0} of 4', Converter={x:Static converters:StepToDisplayConverter.Instance}}"
                   VerticalAlignment="Center"
                   HorizontalAlignment="Center"
                   Opacity="0.45"
                   FontSize="12" />

        <Button Grid.Column="2"
                Content="Next â†’"
                Command="{Binding NextCommand}"
                IsVisible="{Binding CanGoNext}"
                Padding="16,8"
                Margin="0,0,8,0" />

        <Button Grid.Column="3"
                Content="Finish âœ“"
                Command="{Binding FinishCommand}"
                IsVisible="{Binding IsLastStep}"
                Padding="16,8" />
      </Grid>
    </Border>

  </Grid>
</Window>
